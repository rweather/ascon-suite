<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ASCON Suite: Building a block cipher with the ASCON permutation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ASCON Suite
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Building a block cipher with the ASCON permutation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <code>block-cipher</code> example in the <code>examples</code> directory uses the Luby-Rackoff construction to convert the ASCON permutation into a tweakable block cipher. Luby-Rackoff showed in 1988 that if you have a pseudorandom function, then you can turn that into a Feistel block cipher.</p>
<p>Follow-up work from Jacques Patarin in 2003 showed that 4 Feistel rounds are sufficient to protect against known plaintext attacks, 7 rounds are sufficient to also protect against adaptive chosen plaintext attacks, and 10 rounds are sufficient to also protect against chosen ciphertext attacks.</p>
<p>In this example we implement encryption for our tweakable block cipher as follows:</p>
<ul>
<li>Break the 128-bit plaintext into two 64-bit halves L and R. </li>
<li>Form an input block B for the permutation by concatenating R, the 128-bit round key K(i), the 96-bit tweak T, and a 32-bit round constant. </li>
<li>Compute B' = ASCON(B) and XOR the first 8 bytes of B' with L. </li>
<li>Swap L and R on all rounds except the last. </li>
<li>Repeat the steps above for the remaining 9 rounds. </li>
<li>Concatenate the final L and R to produce the 128-bit ciphertext.</li>
</ul>
<p>The round keys of the key schedule are computed as follows:</p>
<ul>
<li>K(0) is the 128-bit input key K. </li>
<li>K(i) is <em>dbl</em>(K(i-1)) where <em>dbl</em> is the doubling operation in the GF(128) field. This makes all of the round keys unique under the same tweak.</li>
</ul>
<p>We use the 32-bit round constants from SHA-256 in this example (our version of <a href="https://en.wikipedia.org/wiki/Nothing-up-my-sleeve_number">nothing up my sleeve numbers</a>).</p>
<p>Other choices for key schedule expansion and the round constants could have been made. The tweak could also have been modified per-round with doubling in GF(96) or some other function.</p>
<p>This example demonstrates the possibility of using ASCON this way. A lot of work is needed to prove this construction secure for ASCON and to choose appropriate parameters.</p>
<p>The example block cipher is about 5 times slower per byte than ASCON-128. This could be improved by reducing the number of rounds of the ASCON permutation that is used each Feistel round (currently 6).</p>
<p>References:</p>
<ul>
<li>M. Luby and C. Rackoff. <em>How to construct pseudorandom permutations from pseudorandom functions</em>. SIAM J. Comput., 17(2):373–386, 1988. <a href="https://inst.eecs.berkeley.edu/~cs276/fa20/notes/Luby_Rackoff_paper.pdf">https://inst.eecs.berkeley.edu/~cs276/fa20/notes/Luby_Rackoff_paper.pdf</a> </li>
<li>J. Patarin. <em>Luby-Rackoff: 7 rounds are enough for 2n(1-epsilon) security</em>. In Dan Boneh, editor, Advances in Cryptology - CRYPTO 2003, 23rd Annual International Cryptology Conference, Santa Barbara, California, USA, August 17-21, 2003, Proceedings, volume 2729 of Lecture Notes in Computer Science, pages 513–529. Springer, 2003. <a href="https://iacr.org/archive/crypto2003/27290510/27290510.pdf">https://iacr.org/archive/crypto2003/27290510/27290510.pdf</a></li>
</ul>
<h1><a class="anchor" id="blockcipher_motivation"></a>
Motivation</h1>
<p>The motivation for turning ASCON into a block cipher is on-the-fly encryption of data on memory buses inside a CPU. Existing microcontrollers typically do this with AES operating in a tweaked block cipher mode where the address in memory is the tweak.</p>
<p>XOR-based stream ciphers like ASCON-128 don't work for this situation. Using the nonce to hold the tweak would involve reusing the same nonce with the same key. Reuse of the nonce allows a stream cipher to be trivially broken.</p>
<p>Tweakable block ciphers operating in ECB mode don't have the same problem. If the plaintext is different in even a single bit, the resulting ciphertext will be very different under the same key and tweak. If the same plaintext is written again to the same block, then the scheme will only leak that the same plaintext has been written. It will not leak the plaintext itself as a stream cipher might.</p>
<p>So how would we do memory encryption in a hypothetical low-power embedded microcontroller that uses ASCON permutation as its main encryption and hashing primitive? Luby-Rackoff allows us to turn the ASCON permutation into a tweakable block cipher and memory encryption becomes possible. Without this the microcontroller would have to embed a second encryption core, such as AES, for the memory encryption case.</p>
<h1><a class="anchor" id="blockcipher_design"></a>
Motivation of design choices</h1>
<p>Other than the structure of the Luby-Rackoff construction itself, the other design choices were largely arbitrary.</p>
<p>The same key could have been used every round but that made me uneasy. Other LWC submissions like COMET, GIFT-COFB, HYENA, ORANGE, and Pyjamask use doubling in a GF field to adjust values from block to block to avoid using the same value repeatedly. So doubling in GF(128) seemed a reasonable choice.</p>
<p>Other methods could be used to modify the key from one round to the next. The round schedule of SKINNY-128 permutes the key bytes from round to round in a manner that is simple to fast-forward to the end of the schedule and reverse for decryption in low memory environments.</p>
<p>Even though the key changes every round there is still a problem with slide attacks. Without round constants, round n of encrypting with the key K uses the same key as round n-1 of encrypting with the key <em>dbl</em>(K). The SHA-256 round constants were added to mitigate the potential for slide attacks. Other round constants could be used instead.</p>
<p>The tweak could have been modified from round to round but it makes decryption harder to implement. The tweak must first be fast-forwarded to the end of the schedule, and then wound backwards round by round. This may not be a problem if the block operation is only used in the forward direction, but that is not the case for memory encryption.</p>
<h1><a class="anchor" id="blockcipher_other_uses"></a>
Other uses for ASCON as a block cipher</h1>
<p>Disk encryption and other forms of data-at-rest can also benefit from a tweakable block cipher.</p>
<p>If the storage for the data-at-rest has space for a 128-bit authentication tag for each block, then an ASCON AEAD in <a class="el" href="siv.html">SIV mode</a> may be a better option. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 3 2022 16:33:53 for ASCON Suite by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
