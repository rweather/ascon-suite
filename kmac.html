<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ASCON Suite: Keyed Message Authentication Code (KMAC) mode for ASCON</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ASCON Suite
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Keyed Message Authentication Code (KMAC) mode for ASCON </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#kmac_intro">Introduction</a></li>
<li class="level1"><a href="#kmac_nist">Standard NIST KMAC</a></li>
<li class="level1"><a href="#kmac_technical">Technical details of ASCON-KMAC</a></li>
<li class="level1"><a href="#kmac_using">Using ASCON-KMAC</a></li>
<li class="level1"><a href="#kmac_other_modes">Other NIST modes</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="kmac_intro"></a>
Introduction</h1>
<p>The KMAC mode provides a method to authenticate a sequence of bytes under a key using ASCON in hashing mode. The input is essentially equivalent to hashing the key followed by the data without the double layers of hashing that are needed for HMAC.</p>
<p>Note: Other hash algorithms like SHA-256 use HMAC instead of KMAC. The HMAC construction is not necessary for sponge-based hash algorithms like ASCON, so the simpler KMAC is preferable.</p>
<h1><a class="anchor" id="kmac_nist"></a>
Standard NIST KMAC</h1>
<p><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf">NIST SP 800-185</a> is an extension of the extensible-output function (XOF) modes SHAKE128 and SHAKE256.</p>
<h1><a class="anchor" id="kmac_technical"></a>
Technical details of ASCON-KMAC</h1>
<p>The nearest equivalent to SHAKE is ASCON-XOF. We use a similar encoding to NIST SP 800-185 to provide domain separation between the key and data. We form the data to be hashed as a concatenation of the following:</p>
<ul>
<li>Declaration of the rate block size, which for this algorithm is the two byte sequence 0x01 0x08. </li>
<li>Length-prefixed function name, which is "KMAC" for this algorithm. </li>
<li>Length-prefixed application-supplied customization string. </li>
<li>Zero padding to a multiple of the 8-byte rate block size. </li>
<li>Another copy of the rate declaration, this time for the key. </li>
<li>Length-prefixed key. </li>
<li>Zero padding to a multiple of the 8-byte rate block size. </li>
<li>The actual data to be authenticated. </li>
<li>Length-suffixed size of the desired output, 0 for arbitrary output.</li>
</ul>
<p>We use the same encoding for length prefixes and suffixes as NIST SP 800-185.</p>
<h1><a class="anchor" id="kmac_using"></a>
Using ASCON-KMAC</h1>
<p>Given a key and an input buffer containing data to authenticate, the output KMAC value can be computed as follows:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="kmac_8h.html">ascon/kmac.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> out[<a class="code" href="kmac_8h.html#a7cd133c2679a76220bb714e6f1825a9c">ASCON_KMAC_SIZE</a>];</div>
<div class="line"><a class="code" href="kmac_8h.html#af77d295266b216a6c2573d209ccaa167">ascon_kmac</a>(key, key_len, input, input_len, 0, 0, out, <span class="keyword">sizeof</span>(out));</div>
</div><!-- fragment --><p>This uses the default output length of ASCON_KMAC_SIZE (32) and a zero-length customization string. Customization strings can provide domain separation between two different uses of the same input.</p>
<p>As an example of customization, say we wanted to derive two different session keys from the same input; one for encrypting data from party A to party B and the other for encrypting data from party B back to party A. We can use KMAC as a key derivation function (KDF) with different customization strings in each direction:</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> atob_key[<a class="code" href="aead_8h.html#a74d1e46abe6ab08aeb2c431344f2107f">ASCON128_KEY_SIZE</a>];</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> btoa_key[<a class="code" href="aead_8h.html#a74d1e46abe6ab08aeb2c431344f2107f">ASCON128_KEY_SIZE</a>];</div>
<div class="line"><a class="code" href="kmac_8h.html#af77d295266b216a6c2573d209ccaa167">ascon_kmac</a>(key, key_len, salt, salt_len, <span class="stringliteral">&quot;A2B&quot;</span>, 3, atob_key, <span class="keyword">sizeof</span>(atob_key));</div>
<div class="line"><a class="code" href="kmac_8h.html#af77d295266b216a6c2573d209ccaa167">ascon_kmac</a>(key, key_len, salt, salt_len, <span class="stringliteral">&quot;B2A&quot;</span>, 3, btoa_key, <span class="keyword">sizeof</span>(btoa_key));</div>
</div><!-- fragment --><p>The two outputs are related to each other but will be completely different due to the different customization strings (<code>A2B</code> and <code>B2A</code>).</p>
<p>ASCON-KMAC can process arbitrary amounts of input and generate arbitrary amounts of output using the incremental API:</p>
<div class="fragment"><div class="line"><a class="code" href="structascon__kmac__state__t.html">ascon_kmac_state_t</a> kmac;</div>
<div class="line"><a class="code" href="kmac_8h.html#a1df25dd7b8c1f50c703ed535c4416ff5">ascon_kmac_init</a>(&amp;kmac, key, key_len, <span class="stringliteral">&quot;A2B&quot;</span>, 3);</div>
<div class="line"><a class="code" href="kmac_8h.html#a6344772e6b64962e2ea64e4e1c6a7f78">ascon_kmac_absorb</a>(&amp;kmac, input1, <span class="keyword">sizeof</span>(input1));</div>
<div class="line"><a class="code" href="kmac_8h.html#a6344772e6b64962e2ea64e4e1c6a7f78">ascon_kmac_absorb</a>(&amp;kmac, input2, <span class="keyword">sizeof</span>(input2));</div>
<div class="line">...;</div>
<div class="line"><a class="code" href="kmac_8h.html#a6344772e6b64962e2ea64e4e1c6a7f78">ascon_kmac_absorb</a>(&amp;kmac, inputN, <span class="keyword">sizeof</span>(inputN));</div>
<div class="line"><a class="code" href="kmac_8h.html#a95d5029c672a5b34889afaf2994d2335">ascon_kmac_set_output_length</a>(&amp;kmac, <span class="keyword">sizeof</span>(out1) + <span class="keyword">sizeof</span>(out2));</div>
<div class="line"><a class="code" href="kmac_8h.html#a7fe5157f6574cc449e84abddac2cf1f9">ascon_kmac_squeeze</a>(&amp;kmac, out1, <span class="keyword">sizeof</span>(out1));</div>
<div class="line"><a class="code" href="kmac_8h.html#a7fe5157f6574cc449e84abddac2cf1f9">ascon_kmac_squeeze</a>(&amp;kmac, out2, <span class="keyword">sizeof</span>(out2));</div>
</div><!-- fragment --><p>If the output length is not set with <a class="el" href="kmac_8h.html#a95d5029c672a5b34889afaf2994d2335" title="Sets the desired output length for an incremental ASCON-KMAC state. ">ascon_kmac_set_output_length()</a>, then it is assumed that the output is open-ended. Open-ended output can also be specified with an output length of 0.</p>
<p>ASCON-KMACA has a similar API, but uses ASCON-XOFA internally instead of ASCON-XOF.</p>
<h1><a class="anchor" id="kmac_other_modes"></a>
Other NIST modes</h1>
<p>NIST SP 800-185 also defines modes called cSHAKE, TupleHash, and ParallelHash, using the same definition style as KMAC. We could define similar modes for ASCON as well but haven't done so yet. They aren't as widely used as KMAC. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 2 2022 12:52:55 for ASCON Suite by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
