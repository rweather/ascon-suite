<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ASCON Suite: Synthetic Initialization Vector (SIV) mode for ASCON</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ASCON Suite
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Synthetic Initialization Vector (SIV) mode for ASCON </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#siv_why">Why SIV?</a></li>
<li class="level1"><a href="#siv_overview">SIV mode overview</a></li>
<li class="level1"><a href="#siv_technical">Technical details for ASCON-128-SIV</a><ul><li class="level2"><a href="#siv_technical_auth">Authentication</a></li>
<li class="level2"><a href="#siv_technical_encrypt">Encryption</a></li>
<li class="level2"><a href="#siv_technical_variants">Variants</a></li>
</ul>
</li>
<li class="level1"><a href="#siv_test_vectors">Test vectors</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="siv_why"></a>
Why SIV?</h1>
<p>This library provides support for SIV mode (Synthetic Initialization Vector). SIV mode authenticates the associated data and the plaintext before encrypting the plaintext.</p>
<p>The SIV construction makes the result resistant against reuse of the nonce as long as the combination of the associated data and plaintext is unique. If the combination is not unique, then the algorithm leaks that the same plaintext has been encrypted again but does not reveal the plaintext itself.</p>
<p>SIV mode can be useful when encrypting other keys for transport or storage under a passphrase. If multiple keys are encrypted with a regular AEAD scheme and the same passphrase and nonce, then the result will be insecure. SIV mode is safer for this use case; even a single bit change in the plaintext will cause massive changes in the SIV-encrypted output.</p>
<p>There are three SIV modes implemented by the library: ASCON-128-SIV, ASCON-128a-SIV, and ASCON-80pq-SIV. Each of these is based on the corresponding standard AEAD modes.</p>
<p>ASCON SIV modes increase the size of the plaintext by 16 bytes, which provides the authentication tag. The tag must not be discarded because the data cannot be successfully decrypted without it.</p>
<h1><a class="anchor" id="siv_overview"></a>
SIV mode overview</h1>
<p>The SIV mode here is inspired by some of the non-ASCON candidates to the second round of the NIST lightweight cryptography competition; notably ESTATE, Romulus-M, and SUNDAE-GIFT.</p>
<p>In each case, the algorithm first authenticates the associated data and plaintext with the key and nonce. The resulting authentication tag is used as a new nonce with the original key to encrypt the plaintext. This requires two passes over the plaintext, compared with only one pass for the regular ASCON AEAD modes like ASCON-128.</p>
<p>On the decryption side, the authentication tag is used as a nonce to decrypt the ciphertext. Then the authentication tag is recomputed over the associated data and plaintext to verify authenticity.</p>
<h1><a class="anchor" id="siv_technical"></a>
Technical details for ASCON-128-SIV</h1>
<p>This section describes the authenticated encryption mode ASCON-128-SIV. ASCON-128a-SIV and ASCON-80pq-SIV are constructed in a similar manner.</p>
<p>The single-pass ASCON-128 AEAD mode is restructured into a two-pass form as shown in the diagram below. The first pass of SIV encryption is identical to the regular AEAD mode, but with the ciphertext discarded.</p>
<p>The second pass re-initializes the state with the original key K and the authentication tag T as the nonce. The ASCON permutation is operated in a simple Output FeedBack (OFB) mode to encrypt the plaintext.</p>
<div class="image">
<img src="ascon-siv.png" alt="ascon-siv.png"/>
</div>
<p>Here:</p>
<ul>
<li>IV1 and IV2 are initialization vectors for the two phases. </li>
<li>K is the 128-bit key. </li>
<li>N is the 128-bit nonce for the authentication phase. </li>
<li>A1 .. As are the padded blocks of the associated data. </li>
<li>P1 .. Pt are the padded blocks of the plaintext data. </li>
<li>C1 .. Ct are the blocks of ciphertext output. </li>
<li>T is the 128-bit authentication tag and the nonce for the encryption phase. </li>
<li><em>p<sup>a</sup></em> is the ASCON permutation with <em>a</em> rounds (12 in the case of ASCON-128-SIV, ASCON-128a-SIV, and ASCON-80pq-SIV). </li>
<li><em>p<sup>b</sup></em> is the ASCON permutation with <em>b</em> rounds (6 in the case of ASCON-128-SIV and ASCON-80pq-SIV and 8 in the case of ASCON-128a-SIV).</li>
</ul>
<h2><a class="anchor" id="siv_technical_auth"></a>
Authentication</h2>
<p>The authentication phase is identical to the regular ASCON-128 mode, with a slight modification to the initialization vector (IV).</p>
<p>The 320-bit ASCON permutation state is initialized with a concatenation of the following:</p>
<ul>
<li>64-bit initialization vector (IV) 0x81400c0600000000 </li>
<li>128-bit key </li>
<li>128-bit nonce</li>
</ul>
<p>Note that the IV is the ASCON-128 value 0x80400c0600000000 with 0x81 in the key length position instead of 0x80. This provides domain separation with the regular ASCON-128 AEAD mode.</p>
<p>Apply the ASCON permutation with 12 rounds and then XOR the key with the trailing 128 bits of the state.</p>
<p>If the associated data is non-zero in length, then add a 1 bit and enough zero bits to make the result a mulitple of 8 bytes in length. Absorb this into the ASCON permutation state in the same way as ASCON-128; for each 8 byte block:</p>
<ul>
<li>XOR the 8 bytes of input with the first 8 bytes of the permutation state. </li>
<li>Apply the ASCON permutation with 6 rounds.</li>
</ul>
<p>Next, XOR a 1 with the last bit of the ASCON permutation state to provide separation between the associated data and plaintext.</p>
<p>Add a 1 bit to the plaintext and enough zero bits to make the result a multiple of 8 bytes in length. Absorb the padded plaintext data in the same way as the associated data.</p>
<p>Finally, generate the 128-bit authentication tag as follows:</p>
<ul>
<li>XOR the 128 bits of the key into the ASCON permutation state starting at byte offset 8. </li>
<li>Apply the ASCON permutation with 12 rounds. </li>
<li>XOR the 128 bits of the key with the ASCON permutation state starting at byte offset 24 to generate the 128 bits of the authentication tag.</li>
</ul>
<h2><a class="anchor" id="siv_technical_encrypt"></a>
Encryption</h2>
<p>To encrypt the plaintext, the 320-bit ASCON permutation state is re-initialized with a concatenation of the following:</p>
<ul>
<li>64-bit initialization vector (IV) 0x82400c0600000000 </li>
<li>128-bit key </li>
<li>128-bit authentication tag from the previous step</li>
</ul>
<p>Note that the IV is the ASCON-128 value 0x80400c0600000000 with 0x82 in the key length position instead of 0x80. This provides domain separation with the regular ASCON-128 AEAD mode and with the SIV authentication phase.</p>
<p>Apply the ASCON permutation with 12 rounds and then XOR the key with the trailing 128 bits of the state.</p>
<p>Encryption uses the ASCON permutation in Output Feedback (OFB) mode to generate a keystream to XOR against the plaintext to produce the ciphertext. The same code can also be used for decryption.</p>
<p>For each 8-byte block of plaintext:</p>
<ul>
<li>XOR the next 8 bytes of plaintext with the first 8 bytes of the permutation state to produce the next 8 bytes of ciphertext. </li>
<li>Apply the ASCON permutation with 6 rounds (note that we do not XOR the plaintext into the permutation state this time).</li>
</ul>
<p>If the final block does not have a full 8 bytes, then it is XOR'ed with the first <em>n</em> bytes of the state where <em>n</em> is the size of the partial block. Unlike in the authentication phase, no 1-bit padding is performed.</p>
<h2><a class="anchor" id="siv_technical_variants"></a>
Variants</h2>
<p>ASCON-128a-SIV and ASCON-80pq-SIV are defined in a similar way using the same offsets and round counts as the corresponding regular mode. The complete list of initialization vectors is:</p>
<ul>
<li>ASCON-128 regular IV: 0x80400c0600000000 </li>
<li>ASCON-128-SIV authentication phase IV: 0x81400c0600000000 </li>
<li>ASCON-128-SIV encryption phase IV: 0x82400c0600000000</li>
</ul>
<ul>
<li>ASCON-128a regular IV: 0x80800c0800000000 </li>
<li>ASCON-128a-SIV authentication phase IV: 0x81800c0800000000 </li>
<li>ASCON-128a-SIV encryption phase IV: 0x82800c0800000000</li>
</ul>
<ul>
<li>ASCON-80pq regular IV: 0xa0400c06 </li>
<li>ASCON-80pq-SIV authentication phase: 0xa1400c06 </li>
<li>ASCON-80pq-SIV encryption phase: 0xa2400c06</li>
</ul>
<p>The key lengths in the ASCON-128 and ASCON-128a initialization vectors are 129 and 130. In theory this would conflict with with a future standard AEAD mode with 129-bit and 130-bit keys. But such key lengths are highly unlikely. Similarly for the 161-bit and 162-bit key lengths of ASCON-80pq-SIV.</p>
<h1><a class="anchor" id="siv_test_vectors"></a>
Test vectors</h1>
<p>The repository contains Known Answer Test (KAT) vectors for ASCON-128-SIV, ASCON-128a-SIV, and ASCON-80pq-SIV in the "test/kat" directory. The vectors were generated with a slightly modified version of the ASCON reference code which can be provided upon request. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 2 2022 12:52:55 for ASCON Suite by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
